// This file was generated by [ts-rs](https://github.com/Aleph-Alpha/ts-rs). Do not edit this file manually.
import type { HunkHeader } from "../core/diffTypes";
import type { TreeChange } from "../core/ui";

/**
 * Reason why a file is being absorbed to a particular commit
 */
export type AbsorptionReason = "hunk_dependency" | "stack_assignment" | "default_stack";

export type AbsorptionTarget =
	| { type: "branch"; subject: { branch_name: string } }
	| { type: "hunkAssignments"; subject: { assignments: Array<HunkAssignment> } }
	| {
			type: "treeChanges";
			subject: { changes: Array<TreeChange>; assigned_stack_id: string | null };
	  }
	| { type: "all" };

/**
 * Information about absorptions grouped by commit
 */
export type CommitAbsorption = {
	stackId: string;
	commitId: string;
	commitSummary: string;
	files: Array<FileAbsorption>;
	reason: AbsorptionReason;
};

/**
 * Information about a file being absorbed
 */
export type FileAbsorption = { path: string; assignment: HunkAssignment };

export type HunkAssignment = {
	/**
	 * A stable identifier for the hunk assignment.
	 *   - When a new hunk is first observed (from the uncommitted changes), it is assigned a new id.
	 *   - If a hunk is modified (i.e. it has gained or lost lines), the UUID remains the same.
	 *   - If two or more hunks become merged (due to edits causing the contexts to overlap), the id of the hunk with the most lines is adopted.
	 */
	id: string | null;
	/**
	 * The hunk that is being assigned. Together with path_bytes, this identifies the hunk.
	 * If the file is binary, or too large to load, this will be None and in this case the path name is the only identity.
	 */
	hunkHeader: HunkHeader | null;
	/**
	 * The file path of the hunk.
	 */
	path: string;
	/**
	 * The file path of the hunk in bytes.
	 */
	pathBytes: number[];
	/**
	 * The stack to which the hunk is assigned. If None, the hunk is not assigned to any stack.
	 */
	stackId: string | null;
	/**
	 * The line numbers that were added in this hunk.
	 */
	lineNumsAdded: Array<number> | null;
	/**
	 * The line numbers that were removed in this hunk.
	 */
	lineNumsRemoved: Array<number> | null;
};
