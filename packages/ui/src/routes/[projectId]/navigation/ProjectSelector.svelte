<script lang="ts">
	import type { Project, ProjectService } from '$lib/backend/projects';
	import Icon from '$lib/icons/Icon.svelte';
	import { map } from 'rxjs';
	import ProjectsPopup from './ProjectsPopup.svelte';
	import { clickOutside } from './clickOutside';

	export let project: Project;
	export let projectService: ProjectService;

	$: projects$ = projectService.projects$;

	let popup: ProjectsPopup;
</script>

<div class="wrapper">
	<div
		class="relative"
		use:clickOutside={() => {
			popup.hide();
		}}
	>
		<button
			class="button"
			on:click={(e) => {
				popup.toggle();
				e.preventDefault();
			}}
		>
			{project.title}
			<div class="button__icon">
				<Icon name="select-chevron" />
			</div>
		</button>
		<ProjectsPopup bind:this={popup} projects={$projects$} />
	</div>
</div>

<style>
	.wrapper {
		margin-top: var(--space-10);
		margin-bottom: var(--space-16);
	}
	.button {
		display: flex;
		width: 100%;
		padding: var(--space-12);

		background-color: var(--clr-theme-container-pale);
		color: var(--clr-theme-scale-ntrl-0);
		font-weight: 700;

		align-items: center;
		justify-content: space-between;
		&:focus,
		&:hover {
			background-color: var(--clr-theme-container-mid);
			& .button__icon {
				color: var(--clr-theme-scale-ntrl-50);
			}
		}
	}
	.button__icon {
		color: var(--clr-theme-scale-ntrl-60);
	}
</style>
