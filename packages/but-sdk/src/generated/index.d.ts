/* auto-generated by NAPI-RS */
/* eslint-disable */
/** r" napi function - strongly typed params, serde_json::Value output, automatic error conversion. */
export declare function stackDetailsNapi(projectId: string, stackId: StackId | null): StackDetails

/** r" napi function - strongly typed params, serde_json::Value output, automatic error conversion. */
export declare function stacksNapi(projectId: string, filter: StacksFilter | null): Array<StackEntry>

// Auto-generated by but-schema-gen. Do not edit manually.
// Generated from JSON schemas registered by #[but_api] functions.


// Auto-generated by but-schema-gen. Do not edit manually.
// Generated from JSON schemas registered by #[but_api] functions.

/** Information about the current state of a stack */
export type StackDetails = {
  /** This is the name of the top-most branch, provided by the API for convenience */
  derivedName: string;
  /** The pushable status for the stack */
  pushStatus: PushStatus;
  /** The details about the contained branches */
  branchDetails: Array<BranchDetails>;
  /** Whether the stack is conflicted. */
  isConflicted: boolean;
};

/**
 * Represents a lightweight version of a [`Stack`] for listing.
 * NOTE: this is a UI type mostly because it's still modeled after the legacy stack with StackId, something that doesn't exist anymore.
 */
export type StackEntry = {
  /** The ID of the stack. */
  id: string | null;
  /**
   * The list of the branch information that are part of the stack.
   * The list is never empty.
   * The first entry in the list is always the most recent branch on top the stack.
   */
  heads: Array<StackHeadInfo>;
  /** The tip of the top-most branch, i.e., the most recent commit that would become the parent of new commits of the topmost stack branch. */
  tip: string;
  /** The zero-based index for sorting stacks. */
  order?: number | null;
  /** If `true`, then any head in this stack is checked directly so `HEAD` points to it, and this is only ever `true` for a single stack. */
  isCheckedOut: boolean;
};

/** A filter for the list of stacks. */
export type StacksFilter = "All" | "InWorkspace" | "Unapplied";

/** Represents the author of a commit. */
export type Author = {
  /** The name from the git commit signature */
  name: string;
  /** The email from the git commit signature */
  email: string;
  /** A URL to a gravatar image for the email from the commit signature */
  gravatarUrl: string;
};

/** Information about the current state of a branch. */
export type BranchDetails = {
  /** The name of the branch. This is the "given name" IE, just `foo` out of `refs/heads/foo` */
  name: string;
  /** The full reference of the branch */
  reference: string;
  /**
   * The id of the linked worktree that has the reference of `name` checked out.
   * Note that we don't list the main worktree here.
   */
  linkedWorktreeId: string | null;
  /** Upstream reference, e.g. `refs/remotes/origin/base-branch-improvements` */
  remoteTrackingBranch: string | null;
  /** The pull(merge) request associated with the branch, or None if no such entity has not been created. */
  prNumber?: number | null;
  /** A unique identifier for the GitButler review associated with the branch, if any. */
  reviewId?: string | null;
  /**
   * This is the last commit in the branch, aka the tip of the branch.
   * If this is the only branch in the stack or the top-most branch, this is the tip of the stack.
   */
  tip: string;
  /**
   * This is the base commit from the perspective of this branch.
   * If the branch is part of a stack and is on top of another branch, this is the head of the branch below it.
   * If this branch is at the bottom of the stack, this is the merge base of the stack.
   */
  baseCommit: string;
  /** The pushable status for the branch. */
  pushStatus: PushStatus;
  /** Last time, the branch was updated in Epoch milliseconds. */
  lastUpdatedAt?: number | null;
  /** All authors of the commits in the branch. */
  authors: Array<Author>;
  /** Whether the branch is conflicted. */
  isConflicted: boolean;
  /** The commits contained in the branch, excluding the upstream commits. */
  commits: Array<Commit>;
  /** The commits that are only at the remote. */
  upstreamCommits: Array<UpstreamCommit>;
  /** Whether it's representing a remote head */
  isRemoteHead: boolean;
};

/** Commit that is a part of a [`StackBranch`](gitbutler_stack::StackBranch) and, as such, containing state derived in relation to the specific branch. */
export type Commit = {
  /** The OID of the commit. */
  id: string;
  /** The parent OIDs of the commit. */
  parentIds: Array<string>;
  /** The message of the commit. */
  message: string;
  /**
   * Whether the commit is in a conflicted state.
   * The Conflicted state of a commit is a GitButler concept.
   * GitButler will perform rebasing/reordering etc without interruptions and flag commits as conflicted if needed.
   * Conflicts are resolved via the Edit Mode mechanism.
   */
  hasConflicts: boolean;
  /**
   * Represents whether the commit is considered integrated, local only,
   * or local and remote with respect to the branch it belongs to.
   * Note that remote only commits in the context of a branch are expressed with the [`UpstreamCommit`] struct instead of this.
   */
  state: CommitState;
  /** Commit creation time in Epoch milliseconds. */
  createdAt: number;
  /** The author of the commit. */
  author: Author;
  /**
   * Optional URL to the Gerrit review for this commit, if applicable.
   * Only populated if Gerrit mode is enabled and the commit has an associated review.
   */
  gerritReviewUrl?: string | null;
};

/** Represents the state a commit could be in. */
export type CommitState = {
  type: "LocalOnly";
} | {
  type: "LocalAndRemote";
  subject: string;
} | {
  type: "Integrated";
};

/** Represents the pushable status for the current stack. */
export type PushStatus = "nothingToPush" | "unpushedCommits" | "unpushedCommitsRequiringForce" | "completelyUnpushed" | "integrated";

/** The information about the branch inside a stack */
export type StackHeadInfo = {
  /** The name of the branch. */
  name: string;
  /** The tip of the branch. */
  tip: string;
  /** The associated forge review with this branch, e.g. GitHub PRs or GitLab MRs */
  reviewId?: number | null;
  /**
   * If `true`, then this head is checked directly so `HEAD` points to it, and this is only ever `true` for a single head.
   * This is `false` if the worktree is checked out.
   */
  isCheckedOut: boolean;
};

/**
 * Commit that is only at the remote.
 * Unlike the `Commit` struct, there is no knowledge of GitButler concepts like conflicted state etc.
 */
export type UpstreamCommit = {
  /** The OID of the commit. */
  id: string;
  /** The message of the commit. */
  message: string;
  /** Commit creation time in Epoch milliseconds. */
  createdAt: number;
  /** The author of the commit. */
  author: Author;
};

